import{H as b,d as X,r as m,c as N,B as Y,e as n,J as Z,o as v,f as T,g as a,w as o,z as F,l as C,h as U,j as V,I as _,y as z,_ as ee}from"./index-D_ItP8f2.js";const ae=(i,d)=>b.get(`/admin/product/baseTrademark/${i}/${d}`),te=i=>i.id?b.put("/admin/product/baseTrademark/update",i):b.post("/admin/product/baseTrademark/save",i),le=i=>b.delete("/admin/product/baseTrademark/remove/"+i),oe=["src"],re=["src"],ne={class:"dialog-footer"},se=X({__name:"index",setup(i){const d=m(1),g=m(5),k=m(0),h=m([]),y=m(""),c=m(!1),t=N({tmName:"",logoUrl:""}),u=m(),w=N({tmName:[{required:!0,trigger:"blur",validator:(e,l,s)=>{l.trim().length>=2?s():s(new Error("品牌名稱不能為空且不能少於2位"))}}],logoUrl:[{required:!0,trigger:"change",validator:(e,l,s)=>{l?s():s(new Error("品牌LOGO不能為空"))}}]}),q=e=>e.type!=="image/png"&&e.type!=="image/jpeg"&&e.type!=="image/gif"?(_.error("上傳的圖片類型只能是jpeg﹑gif﹑png檔"),!1):e.size/1024/1024>4?(_.error("圖片的檔案大小不能超過 4MB!"),!1):!0,O=e=>{t.logoUrl=e.data,u.value.clearValidate("logoUrl")},$=()=>{z(()=>{u.value.clearValidate("tmName"),u.value.clearValidate("logoUrl")}),t.id=0,t.logoUrl="",t.tmName="",y.value="添加品牌",c.value=!0},D=e=>{z(()=>{u.value.clearValidate("tmName"),u.value.clearValidate("logoUrl")}),y.value="修改品牌",t.id=e.id,t.tmName=e.tmName,t.logoUrl=e.logoUrl,c.value=!0},E=async e=>{(await le(e)).code===200?(_.success("刪除品牌成功"),p()):_.error("刪除品牌失敗")},L=async()=>{await u.value.validate(),(await te(t)).code===200?(c.value=!1,_.success(t.id?"修改品牌成功":"添加品牌成功"),t.id||(d.value=Math.floor(k.value/g.value)+1),p()):(_.error(t.id?"修改品牌失敗":"添加品牌失敗"),c.value=!1)},p=async()=>{const e=await ae(d.value,g.value);e.code===200&&(k.value=e.data.total,h.value=e.data.records)},P=e=>{d.value=1,g.value=e,p()},j=e=>{d.value=e,p()};return Y(()=>{p()}),(e,l)=>{const s=n("el-button"),f=n("el-table-column"),A=n("el-popconfirm"),B=n("el-table"),M=n("el-pagination"),S=n("el-card"),G=n("el-input"),x=n("el-form-item"),H=n("Plus"),I=n("el-icon"),R=n("el-upload"),J=n("el-form"),K=n("el-dialog"),Q=Z("has");return v(),T("div",null,[a(S,null,{default:o(()=>[F((v(),C(s,{type:"primary",icon:"Plus",onClick:$},{default:o(()=>[U("添加品牌")]),_:1})),[[Q,"btn.Trademark.add"]]),a(B,{style:{margin:"10px 0px"},border:"",data:h.value},{default:o(()=>[a(f,{label:"序號",type:"index",width:"80px",align:"center"}),a(f,{label:"品牌名稱",prop:"tmName"}),a(f,{label:"品牌LOGO"},{default:o(({row:r})=>[V("img",{src:r.logoUrl,alt:"未有圖片",style:{width:"100px",height:"100px"}},null,8,oe)]),_:1}),a(f,{label:"品牌操作"},{default:o(({row:r})=>[a(s,{type:"warning",size:"small",icon:"Edit",onClick:W=>D(r)},null,8,["onClick"]),a(A,{title:`您確認要刪除${r.tmName}嗎?`,icon:"Delete",width:"250px",onConfirm:W=>E(r.id)},{reference:o(()=>[a(s,{type:"primary",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),a(M,{"current-page":d.value,"onUpdate:currentPage":l[0]||(l[0]=r=>d.value=r),"page-size":g.value,"onUpdate:pageSize":l[1]||(l[1]=r=>g.value=r),"page-sizes":[3,5,7,9],background:!0,layout:"prev, pager, next, jumper, ->,sizes, total",total:k.value,onSizeChange:P,onCurrentChange:j},null,8,["current-page","page-size","total"])]),_:1}),a(K,{modelValue:c.value,"onUpdate:modelValue":l[4]||(l[4]=r=>c.value=r),title:y.value},{footer:o(()=>[V("span",ne,[a(s,{onClick:l[3]||(l[3]=r=>c.value=!1)},{default:o(()=>[U("取消")]),_:1}),a(s,{type:"primary",onClick:L},{default:o(()=>[U("確認")]),_:1})])]),default:o(()=>[a(J,{style:{width:"80%"},model:t,rules:w,ref_key:"formRef",ref:u},{default:o(()=>[a(x,{label:"品牌名稱","label-width":"100px",prop:"tmName"},{default:o(()=>[a(G,{placeholder:"請您輸入品牌名稱",modelValue:t.tmName,"onUpdate:modelValue":l[2]||(l[2]=r=>t.tmName=r)},null,8,["modelValue"])]),_:1}),a(x,{label:"品牌LOGO","label-width":"100px",prop:"logoUrl"},{default:o(()=>[a(R,{class:"avatar-uploader",action:"http://sph-api.atguigu.cn/admin/product/fileUpload","show-file-list":!1,"on-success":O,"before-upload":q},{default:o(()=>[t.logoUrl?(v(),T("img",{key:0,src:t.logoUrl,class:"avatar"},null,8,re)):(v(),C(I,{key:1,class:"avatar-uploader-icon"},{default:o(()=>[a(H)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),ue=ee(se,[["__scopeId","data-v-93779cc3"]]);export{ue as default};
